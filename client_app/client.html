<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Library Book Inventory</title>
    <meta name="description" content="">
    <meta name="keywords" content="Library Book Inventory Application">
    <meta name="author" content="Agaba Andrew">
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</head>

<body>
    <div class="container mt-5">
        <h1 class="mb-4 justify-content-center">Library Book Inventory</h1>
        <div class="row">
            <div class="card mb-4 col-md-4">
                <div class="card-header">Add New Book</div>
                <div class="card-body">
                    <form id="add-book-form">
                        <div class="form-group">
                            <label for="title">Title</label>
                            <input type="text" id="title" name="title" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="author">Author</label>
                            <input type="text" id="author" name="author" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="isbn">ISBN</label>
                            <input type="text" id="isbn" name="isbn" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="publicationYear">Publication Year</label>
                            <input type="number" id="publicationYear" name="publicationYear" class="form-control"
                                required>
                        </div>
                        <div class="form-group">
                            <label for="publisher">Publisher</label>
                            <input type="text" id="publisher" name="publisher" class="form-control" required>
                        </div>
                        <button type="button" id="add-book-button" class="btn btn-primary">Add Book</button>
                    </form>
                </div>
            </div>
            <div class="card mb-4 col-md-8">
                <div class="card-header">Get Book Details</div>
                <div class="card-body">
                    <form id="get-book-form">
                        <div class="form-group">
                            <label for="search-isbn">ISBN</label>
                            <input type="text" id="search-isbn" name="isbn" class="form-control" required>
                        </div>
                        <button type="button" id="get-book-button" class="btn btn-primary">Get Book Details</button>
                    </form>
                </div>
                <div class="card">
                    <div class="card-header">Book Information</div>
                    <div class="card-body">
                        <table id="book-details" class="table table-bordered" style="display:none;">
                            <tr>
                                <th>Title</th>
                                <td id="book-title"></td>
                            </tr>
                            <tr>
                                <th>Author</th>
                                <td id="book-author"></td>
                            </tr>
                            <tr>
                                <th>ISBN</th>
                                <td id="book-isbn"></td>
                            </tr>
                            <tr>
                                <th>Publication Year</th>
                                <td id="book-publicationYear"></td>
                            </tr>
                            <tr>
                                <th>Publisher</th>
                                <td id="book-publisher"></td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <script>
            $(document).ready(function () {
                $('#add-book-button').click(function () {
                    const title = $('#title').val();
                    const author = $('#author').val();
                    const isbn = $('#isbn').val();
                    const publicationYear = $('#publicationYear').val();
                    const publisher = $('#publisher').val();

                    const xmlContent = `
                    <book>
                        <title>${title}</title>
                        <author>${author}</author>
                        <isbn>${isbn}</isbn>
                        <publicationYear>${publicationYear}</publicationYear>
                        <publisher>${publisher}</publisher>
                    </book>
                `;

                    $.ajax({
                        url: 'http://localhost/library/add-book',
                        type: 'POST',
                        data: { xml: xmlContent },
                        success: function (response) {
                            alert(response.message);
                        },
                        error: function (xhr) {
                            alert('Error: ' + xhr.responseText);
                        }
                    });
                });

                $('#get-book-button').click(function () {
                    const isbn = $('#search-isbn').val();

                    $.ajax({
                        url: `http://localhost/library/book/${isbn}`,
                        type: 'GET',
                        success: function (response) {
                            const parser = new DOMParser();
                            const xml = parser.parseFromString(response, "application/xml");
                            $('#book-title').text(xml.getElementsByTagName('title')[0].textContent);
                            $('#book-author').text(xml.getElementsByTagName('author')[0].textContent);
                            $('#book-isbn').text(xml.getElementsByTagName('isbn')[0].textContent);
                            $('#book-publicationYear').text(xml.getElementsByTagName('publicationYear')[0].textContent);
                            $('#book-publisher').text(xml.getElementsByTagName('publisher')[0].textContent);
                            $('#book-details').show();
                        },
                        error: function (xhr) {
                            alert('Error: ' + xhr.responseText);
                        }
                    });
                });
            });
        </script>
</body>

</html>